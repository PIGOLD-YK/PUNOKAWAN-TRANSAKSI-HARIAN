<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Transaksi Punokawan Group</title>
    <style>
        body {
            background-color: yellow;
            text-align: center;
            font-family: Arial, sans-serif;
        }
        h1 {
            font-size: 24px;
        }
        .content {
            font-size: 20px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>Data Transaksi PUNOKAWAN GROUP</h1>
    <p id="datetime" class="content"></p>
    <p class="content">Transaksi / Hari Ini</p>
    <h2 id="total-transaksi" class="content">Memuat...</h2>
    <p>Powered By PIGOLD th 2025</p>

    <script>
        async function fetchData() {
            const apiKey = "YOUR_GOOGLE_SHEETS_API_KEY";
            const sheetId = "1WRaA_8OTcR42t01CLehqw20ZN0nWB64xSgSEdl54vIY";
            const range = "DataTransaksi!G:G";
            const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${range}?key=${apiKey}`;

            try {
                const response = await fetch(url);
                const data = await response.json();
                
                if (data.values) {
                    let total = data.values.flat().reduce((acc, val) => acc + parseFloat(val || 0), 0);
                    document.getElementById("total-transaksi").innerText = `Rp ${total.toLocaleString("id-ID", { maximumFractionDigits: 0 })}`;
                } else {
                    document.getElementById("total-transaksi").innerText = "Rp 0";
                }
            } catch (error) {
                console.error("Error fetching data:", error);
                document.getElementById("total-transaksi").innerText = "Error mengambil data";
            }
        }

        function updateDateTime() {
            const now = new Date();
            const days = ["Minggu", "Senin", "Selasa", "Rabu", "Kamis", "Jumat", "Sabtu"];
            const months = ["Januari", "Februari", "Maret", "April", "Mei", "Juni", "Juli", "Agustus", "September", "Oktober", "November", "Desember"];
            
            const dayName = days[now.getDay()];
            const day = now.getDate();
            const month = months[now.getMonth()];
            const year = now.getFullYear();
            const hours = now.getHours().toString().padStart(2, '0');
            const minutes = now.getMinutes().toString().padStart(2, '0');
            const seconds = now.getSeconds().toString().padStart(2, '0');
            
            document.getElementById("datetime").innerText = `Tanggal: ${dayName}, ${day} ${month} ${year} | Waktu: ${hours}:${minutes}:${seconds}`;
        }

        setInterval(updateDateTime, 1000);
        fetchData();
    </script>
</body>
</html> 
